// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#@##~@@###$######@####@@@#@@#@@@#=@=@$$#@@$!:!;*#:;:::!!:~:;;*$$@=*;;:!=*@@@@@@@######$##############$$$$$$$$$$$$$#############$$$$$$$$$$$$$$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#@@@#@$@@@@##@@@@@#@####=@#@##=##########@@@##@###$#==!$=#@@##*::;==;:~::::~~~~;;**@=;::;;;*$@@@@@@@@@#############$####$$$$$$$$$$$$$$#########$$$$$$$$$$$$$$$$$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#@@@##=*==###@###############=###@=#@##@###@@@#$##=$$!*:!;;*###*$!~:;;;::~:;;~~:-~!!:=@**!;*!**#*$#@@@@@@@@=@########$$###$######$$$$$$$$######$$$$$$$$$$$$$$$$$$$$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@$==#@@@#$$=**;=$###########$###!###@$@##=#######$;$*!!;;~!;;;*=#~!:~--:~;!:;;!:;--~;:;*##*$;=*$$=;=#@@#@@@@@@######$##$$$##$#$####$$$$$$$$#########$$$$$$$$$$$$$$$$$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;,-:!=#@$$****;;:!=#$########$$$*########:#=#$#==!=*!~~;:!;;!!$=-;--,-~~;*;::*!!~--~;!;@#$#$$;$$!;!*@#@@@@@=@@@@@$####$=$#############$$$$#########$$$$$$$$$$$$$$$$$$$
// @#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#~,. .,~!*==*!!*!;!;!**!$$$=#$$=$=*#$###=#$:***=***=!;~~~:;;!;:=!,--,-~~~***~;!$!-~-~~*$@@##$=;*:;::;!*#@@@@#@@@@######$=#######$######$$$$########$#$$$$$$$$$$$$$$$$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@!~,....,,:!*=**=!!;;;!;;!!;!$$$#$$=$##$#*$;!*;*==**!::~~:::!;;!;---,-:!!=**:*$#*:--,:~$=#$==!!:~;:~:;!$#@@=**$*#@@@@##$$###############$$##########$$$$$$$$$$$$$$$$$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#;;:,....,.-:!*==*!!;;;;;:;;;!$#$$==$=*=*=;;!!;!!!!;:~~~:;!:!;:;-,-.-:!*!=!~!*=*!---~!=@#:***=;::~~~!:==$=##=*=###@##@=#####$##########$#########$#$$$$$$$$$$$$$$$$$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@!~--.......,~;***;;*!;;;:;;!=!=$$$=;!!;!;!:!;!;;!~;~~~;!;;::;;-...-==*;*;:!=$$;---.:=#$;$***:~:~~~~;=*===*=*#$=#$##$=@###############$#$#$###$#$$$$$$$$$$$$$$$$$$#$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#$*:~-,,...,,-~;*;!!!;;;;!!!!*==**!:;~;:;!;*::;!-:-:~;;::~;:,,,.,-*!!!*;!*$#=:-.,,~!#=**=:*:-:~-:,;==;**=$===*$=$###@##############$##$#$##$$$$$$$$$$$$$$$#$####$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#$*:-..,,..,,.--~;!***!!!!*!**=***:~:-~;!!=;;~:,-,~;;!;;;!:,.,.,,:!!*::;=$=*---,,~*!*=$$!*;:-~-~:;!!*$**!!;;!!*$=##@#$#########$$$$###$$$$##$$$$$$$$$$$$$###$##$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#=*!!!;-..,.. ..,-~:~!=!;;***!=!~*;-,~::;!::::-,~-~;;!~;!!~,.,,,,-;*;;;!!=$-,-,,,,*=~***=*;;:~--:;;!*=!!!:;;;;==$$##=*$#$*$$###$#$##$$$#$$#$#$$$$$$$$$$#$#######$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#!;:~~:~,,,.,....,,,,-::~;~~~~~;!;~~-~;!;;~~::,~~-;!;!;;!-~.-,,,-;;!:;*=$=!--,,,,;=;!=!*!:~~~~~:;~!*=**~;~~;*!:!=***!$=*$$##$##$#####$$$$$#$#$=$$$$$$$$#@@######$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#$*=;--,.,,,...,,..,.. ,,,.,,.,,-~,~:,;;!;~~::,~~-~!$*:-;:~~~-.,,!!::~*=*;:-~~,,,!=-!!!-;-~-~~~:!!*==*~;~~-:;!:!=;;**!*=$$##$#@@@$$##$#$=$$$=**=====$$$=$@@@####$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#*;;~::~-,,,,..  ....... ..,,.,,--::;-:;:~~~:--::;*$=~~~~~;;-,,~*!~~:!=!-:~:--~.;*~!=;:!~~,-:~:~;**!!~*~~~:;~:!:~:*;!*=$=###@@@#$@@#=*=;!!;!!**===!~-,,-~;##$###
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##*;;;;~-...,,...,..., ,,.-..-,--,-:~;;,:;~-:~:::*;=$*~-~;:=:~,,:!:-:-;!~.,:*!::~~;;#*;;!*-~~~~~!:!*!;;;~~-;--~~~;;*;*!==$$#@@@@##$**!:!;;!!*$$=:--,......,-:$##$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#=;;:---,~......,.....,...,,,.,-~~~;;;~,:-~~:-:!==!$;-~:;!$!:-,,;-::~~:,-,;*=;:-~:*!*:*!!,~~::~!:;!!!;~;:~-~~:.~:::!!=$=$#@@@@@$*!!!!!;!!!=$!-,.........-,--*$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##;~~~--,., ,..   ..,.......,---,;::!!:~--~-~;:;*=;=;~:~:*$!:-,-~~::~:-,-~:*$=:;,~#;$!=!~~;-~~~-~:!;!:;~~,--,.,-~~:*!==$$#@@@#$=$!!*!!!==;;-,.,....,..--~::~:=$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#*:--,,,,....,,-,,,,,,.,...,,-~,~:::;!;;~:-::!:=*=*::::*:$;~,-:;:!~-~-,,-:!#!~:~--:;=$:-~:~-~~::;;:~~~:~~~-,.,,~~!~*$==$$#$$$=*!****!!!:,,,..-,,,..,~~~!!;;!$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@###*~--,~-,..,-,..,,-,,-,...,,--~~~~:;;:!:~~:--!;!!;:--,;!*!*:-,--:!-,-,---;*=~:.,--;!#*~:~~~~--::;~::~~:~~~-,,,,--,--~~;**$=$==**;;!~~-,,....,,-,,,-~;;;;;!!=$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@####;----,--,,.--.,,,,-,,..,.,~~:~;:-;;::;;~,~:!;;!!--,,-:-!=;~,--:~~~,,,~~:!-:;-,.,~$=*;::~~~-::~~:::~::~--~-,,...,,...,-~;!;;;~---,--,,...-~,,-~::::;!:*;:;=$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@###$:--,--.-~~,..,.,.,..,,.-,,-::~:;!:;::::.-~-!;::,,-,-,~~*;~~:,;~;-,~~:;!:;~~,--:~;!:;;~-~~~~~~:~:;;:~~-~~---.,,,.....,.,,,,,,.,,..,.,,,-,,-~~:;;!!*!!!~:!$$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#####$!,,---,,.. ...,....,,,-,~~-~~:!:!;-*;!:~-~~::::,-,,,,~:!:~~::!~;:~--*!:---,,~-~-:;;~:::~:~-~::~:-~:~:~;---,...,.............,,,.,,.---,,.,,~~:::!!!!:~!=$$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@######$~,,,,,...,,,........,---:::~:!!*;;:*;~:~~~:;;;--,,.--;;:-~:;;~:-~,~;*~,,.-,.-,~~~;::~:-:~:-::-:-::-:;~~--,.,....,.,..,..,~~--,.,,.,. ,,,--~--~;;;:~-,;$$$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#######!,...,......  .,,.,.,---~~:;::!!**!;;;--~~~;:~-,,..--:!~~;~;;:!-~-;~;,,....-,-;;::~~~~:;:-~:::;;::~:~-:~~,,,..,-,,.,-,~~,,.,.,....,..-,~~~~:;~:~--,.-!$#$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@########=,....,,..    ....,,-,-~~~~:!**;*$*;*-,-~;;;~:-,,..,--;-;::!;-!-~~:;;,. ,.,,--;~:;----;~:!;!:~:;::::~~~-~-,, .,,,,~---,, ....,,,~,.., -,-:~~~~~~,,,~*$$$$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@########=,..,..,  ......,,,-----~-~:!**!*$:*~!,-~;*-;:,,...,,~;~!;~!::-~::;~-.. ..,,,;;!!:---~:;!=$;;;~:~::~~~~~~-,,,,,,,,,---,,,,,,..  ... , ,~,-----....,:$$$$$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#######=-........ .  .,,-,------~;:;=$$$=#;;,-,~**=!,~,,..,,-~-::~:-~::~-~:-.. ..,-,!;;!:--~:~*!==!!~;;:~:-~:~---,--.,-~~~,,-~--,...,.. ...., -,-,,,,,...,*$$$#$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#####$$!,  ....    ..--,~--,--:~-;!!=$$$=*;-,-~=$$~:,,.  .,:;~::::-;-~---,-. ...,,!!=!!-:-,-!:**=*!;::::--:--~~--,,--~--~-,.,,..-,,...-,. .,.,.,,,,....,;=$$###$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@######$*-....,,~....,,~~,----~,:::**====$#*~,.~!$!!~...  ,,~,-:~--.:,,~.,.,  ...,-*!*!;~,,,~~;$***$;;;::~~~~~~--,---,-,,-,,,.,.,..--,,-..,  ,-.,,,,....,*$$=###$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#####$;-...,,. ... ,,-~--,-~~-~:;!!;!!!!!;---:!$=!~-.   ...~.--.-,~.-~..,,    ,-~*!$=;:,,-.!;!=#$$*!*;~-~-~----,,.--,-,,,,,,..., ., ,,,,.~, ... ......;$$$=$###$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@######;.  .,~--. ..-.--~-:--~~~~;;!~-:*:!!:,-~;=;*~~       , ,-..,~ ,,.. .    ,-!;$==!-,-,;;*###$$==*!:--~~--~-,-~----.,,.,,...,~-..,,,,,.,.,...  ...,=$$#$#$#$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#####$=,  ..,---- ,...~~~-~-,:-~::!;;~-~~!!*..~;!*:,     ....,,-.,~.,.,  .   .--;*=$!~,,-:!=$=*$==$*=;:~-~~~--,-----,,,......,,.....,.--,.,........ .!$$$$$$$$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#####==.  .,---,-..-----~~-~-:::-~~::-~--;~,,,~;:~.      ... -~.,...., .    .--:!$*:-,.~*====!!*!=**;~:~---,~-,-------,,.....  ,......,,,..... .. .-*=$$$$$$$$$
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@##@@@@@@@@@@##$##$- . ..,.,,,,-,,----~~:-~--~,~~:-,~.:...:~:-      ..,-.,-,. ,..- .    .,-;!=;-,,:**=;;;:~::;!;;:~~--,,---,,-,--~,-,,...       ...,,,,,....   -*$$$$$$$$$$
// @@@@@@@@@@#@@##@@@@@@#@@@@#@@@##@@@@@@@@#@#####$!.........-,-,~-----~~~--,,~~,---,-,, .--- .     ...,... ..,.,..     .,-:;:~,,--!:~--~~~:;;~:;~~~-----------~--~--,...     ..-.,---,... .  .!=$$$$$$$#$$
// @@@@@@@@@########@#@@##@@@###@####@@@@##########=,.....,,,,-------,-~,~,-.-,, ,,-,....  ,,.      ..........,....      .~::~,.,~-~,--~--~~:~~:~~-,-,-----------~~-,..   . . ..,--~-,--,..,. ,!*$$$$$#$$$$
// @#@@@###@@###############@###@#@###@@@@@@@####$$=-,,,..,,--,,-,,---~:~-.-,-...,.,...,  ...      ............,..        .-- ,.,,,,,.----~----~~----,---,,---,-~--,,......,...,------,. .   ,:*$$=$$$$$$$$
// ###@@@##@@@@#####@#@@########@@@@####@##@@######$:,...,,-~~---,-,--~~---,. .,-,-,.~-      .     ..,...... ...,..       ,    .. ~~,.....,,-,-.~~--,----,--,,-,---~--,.,.. ..~,--~~,,.,... ,:*==$$$$$$$$$$
// @#######@@@@@######@@@@#####@@@@@###############$;-,..,,--~--,,,,---:-,,--,.,,-!==!;~-..       ...,- .., .. ,..            . ,.,,.-,.,,..-,,-,--,~-~-,,,--,~~--,,~--,,...,~-----,,,,...  ,:!=$$$$$$$$$$$
// @#######@@@@@@#@@@@@@@@##@##@@@@##@############$$!-...,-~:--,,,,---~:~,,.,,,~;$##@@@##$-.         .. ,.,.. .-...          ..-,,-,-,,........-,,~-,~--,,,,--~~--,---~,,,....~~~--,.,.,.  .,*##$$$$$$$$$$$
// @@@##@#@@@@@@@@@@@@@@@@####@@@@@#@@##@########$##!;-,.-::---,------------,,~:*$@=====*$#$-      ..,. .. .. .-,          .~*=$$####=!-.,,-,,--,,----~,,,,--,-------~~,,,..,~,-,-.....    ,**#$#$$#$$$$$$$
// @@@#@@#@@@##@@@@@@@@@@#####@@@@@@@@###########$$=$!-,-~:;~~~~~~~-----~~--,-~~$=!***==****#,     ..,. ...  . -,         ,!$$=***=*$@#=!-.. ...,,,--~~~-,,-,,---,,,-~-~-,,,,-~,,...  .    ~*=$###$$$$$$$$$
// @@#####@@@@@@@@@@@@@@######@@@@@@@#############$$*!~~::;~~~-~~----,-,--~--:~*=!!*#@@@#*!**$.      ,. .. .., , .       .*$!!!*==**!:;#=;~.... .,-,-,,--,,,,,,,,----~::~~-,,,,,,....... .,!=$#@###$$$$$$$$
// @#####@@@@##@###@@@@@@@@###@@@##@@#@##########$#$$$!;;!::-~~~~~~~-----::- ,:!;**##@####*::=,     .,....,..,,. .       ;::;;=#@@#=**:*$#;~,,--,,,-,--,,,,--,,-~~~~~:;;:~,-,--,--,,.-,..,:*=##@@##$$$$$$$$
// @#####@@####@###@@@@@@@@####@###@@@@#######$$$$$$$$*::;:::::;;;!;;;;!!:,...-;!*#@##$###$!:;~     . .,.-...,.,.       -,!!;=#####@=!;~*$$;,:-,,-,-,,,--~~---,,-~----:;;;~-,----,,.,,.,,-;!$##@@##$$$$$$$=
// @@@###############################@@########$#$$=$*;;!;::~~::*=$#=$$;~.   ,!;*=#@##$$!=*;~:=.    ., .. ....          !!:;*###$##$#*!:~!$;;-~~~-~~---,,,----,-----~:~;;*;~-,--.,.,,,..-~:!$######$$$$$$==
// @@@################################@########$$##=!;:;;:::;:;*$@@#=**;-,   -=;*=#@#$=*  !;~~$,    . , ...  .         ,=~:;$##$=*$##$!::!=*-.-.~;::~-~-,-,,-,,--,,-,-:~;:;;~--,,,..,,,,-:;!*#####$$=$$====
// #########################################$$$$$$$$*!::;::::!!=#@=*!;:~,.  .:=**=##$=***;!:~-$:    .... ...  ,      .,;#~:;###$; -$#$!::;*!,..-~~;=*::---,,,---,-,-----~~;:-~--,.,,--,--~~!=##$$$$=$$=====
// ##########################################$##$#=$=;;;:;:::*=###*;*=;~,    ;==!=##$=!=$=;;-!=*,    .  ...  .      .,!==::;###$*,!$#=!:;:=*- ..~~:*===!!;~~~~~~-,-,,--~~~::;~-,,---,-:~::;=#$===$=========
// ###########################################$$$$$*!!!;;::;!=$$!;;:**:-..  .!*;;==@$==$$*;-:* *-   . ... ,...     .,;==#!~;$#$$$*=$=*=:::$*,   .,~-:!*=$$**!;~~~---~:~~~:;:::------~:;!!=$$$===$========$$
// #########################################$##$$#=**!*;;~;;=$$!:;;;;!!-,.   -;=*;==#$$=!!;!$$$=!, ...  ,...       .~**$:$~;!###$$$#$!!~~*$~,    .,~:::*$###$$=!!;~:--~:::~:::~~-~-:;;:;!#$$==**=****===$$$
// ###########################################$#$#$****!;:;;=#$*;!!!!!;;--.  .~!#!=*=****!:$,=$$*:,,... .,..,.... ,~***=-#!:;*$=$$$=!*:~;$*~    ..-~::;;;!$$$==*=!!!*!;:~::~;~---~;**$$=#$#$*********==$$$$
// ############################################$=$$$$=*!;!*==#!**=!;=**;:~..   -:$$==!!!:~-::*!$=*:.,..,,,,.,.,..-~*****$==;*!!*=**;!;~!$=;.    .-~;**;~::!!*#$#$$=*!!;:::;!;;~-,,:~;!$$##====*******==$$$$
// #########################################$$###=========$##$!*!***!!*!:;-,..   .,..     ..~!=$*:~---,,---,.,,-~=====;*!:;.:;;;!!;;:~;$=;,    ...~!*!;::~~!;#####=$$=*!!!;~!!:--,-~!*=$##$$==***!***==$$$$
// ##############################################$==*!!;*###=!:~*$$**=!**;:--,             .:*$!!:~--~-..,,.-,~:;*$$===;--,. .~;!;!:;=*;,.     .-;!=*!;:-:~~-~*#$$##$$$*!;::;;;~----:=#@@###==**!!!!!*=$$$$
// #$#########################################$$$$=$=!;*=##$!~--!!==!=**!*;;:~-..     . ...-*=*;*!~:~,,------~-;;*=$$=*;.         .,. ..     ..-;!!!;~:;:;~~~~:*$#####=*!;:;!*!:-~-,:!$#@@#$$=**!!!!!*=$$##
// $$$$$$$$##$###$#######################$#$$$$$$$$==***$#$*;~--~:!**:;;;;;::-~~-~-,.-,,,.,:=!!!;!~~-,,~~~,--~~;:!*===!;-                   .,~:!!*=!;;;;;!;;~~~:*=$=$$$*;;::;;!~~~~~;*##$#$$==***!!!*==$$$
// $$$$$$$$$$$$$#$######$###############$$$$$#$$$$$$=*!*$#@@=;~--~;!;::~~:~~;;:~;~~,,,~-;;;!*!;;;:~~--~~~~--~~-~*;!==*=:~,.         .  ,,~,,,-:!***!:~;!=====*;--:=$@$##=;;;;!!;~~~~~~!*@#$$$==*===****=$$$
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$#$###$##$$$$$$==$#$===$$#@@@@$:~---;*=!:::~~~~;;:--~----::!;;!~,,-~~~~--:~-~~~-,~;!!*=*=!*:-..  .,,,,.,,---~~--:;;:~-:;;=**!**;~,,~:!:!$!;!;:::;;:~;:-:;!#=@@$===$$=****=$$$
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$###$$$$$$$$$=*=$####@@@$*;~-~::*#=$#=!=!!!;~~~,.---;:;~;-~,-,~:~--~~~~--~:--,-~:;!!*=!!~--,-.,,,..,---~~~~~,-~-~-~~;::~-~:~-,,,-~!$$$*=!;;:;!!;;~~:;$=$$===$##$=****===$
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$=$$##$=*!~-~;*!!==$##**!;!;,-,,-,~!!**;:,...-~::~~~:~~~~~~:--,,,,:-;;::;~~----..,~~,--,-:;!::--~~::;:~,...,.,,,,~!*$*;***!!;:;;:~~::;*!***$=$======$$$$$
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$=$===***=$###*~-~!====$=!:~~::~,,, .,-=*$=*;... ,-:!~;:;:;:;:~:::-,,  .~-~!*!;~-,,--,,,~~,-:;:~::;;*****!;;-,.,   ...-~!!=$#$=$***=;::;;;;!*==$===*==$$$$$$$$
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$=$$==***=$=!;-,,-~:!!;!;;!:;!!!:-.....,:!$$!;,   .:!!***!;~;;*;!;!-..  . ,-;$$$=:-.,~--.,~~::~~::!:!*!===;;;-,.--....,..:;=###$@@#*!*!;~~~;!!!****!*$$$##$$$$$
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$#$$$=$===**===$=!::~---~:*==*!;!*!!~-,,...--.,-,--    .;!***=!!*!$=$*=!:-     .:===$=!-,..,-~,,--.-~~-~~~;!***;~::~-,-,... .,-~;;!*=$$$$#=!;!;;;*!*!;;!*=$####$$$$$
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$===*===***==!:~~~-~-~::*!;:!**!:-..  ..  . ...,.   ;*=**!!!=!=*!*!;!~     ,~*!;***:-,....--,--~:~-~-~~~;;!!;:~:!;;--,.. .,*$$$=$=*!*=$=!;;!!!!!!!!**$#@@##$$==$
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$#$**!**!!!*=*;:~~:::~~:~:!!*;;::-,,. .., .     .   ..!##***=;;!!=$==:..   -,.~,-~-~;-,,...,,-,,~:~:~;~~:;:;!!**=!*;:-....,.,-*$==###$$$=*;!;**!!;;;*$#@#@##$====
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$#$$$$$$$=====**$==!;~~::;!;::;;=--~~---,,..  ....        .-*#$!****=**=*:,.   ., .  ,.,,---.  ...-~-~~!!!;*;**!!=!!***!!~,,.... ..~::*$$=!;*!;;;**=**!**$$$####$===**
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$#$$$$$#$$$$$$$==*****!!!~---:!*!;::.~;*::;~--,,,. ..,.,          -*$*!====;:*:.           .. .......  .,-~~~;;;!**===*!;;~-~~~~--,,......,-:;!*=*$!::;=*!******==$$$#$===**
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$====**!!!!::~::;*==$.~;!~:*:!!:-,,,-...              ,*!!=$*!=;*:.,          .,......... ...,,-,,,~:-;!;*:~--,,~~~~-~--,....,,,~::!**!:~~:;;=$=*!!!***=$##$$===
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$#$$$$$$$$$$$$==*!;;:;;!*$=#!~*$$*:;~:~:;~--..,-, . ..        ..,*===$*==;~-,         ..--.... .. ..  .,.--,.,-~::;:~-,.,,~~~;:;~--,,,,.,,,,--:;;;;::::::!;;!;!!*=$##$$===
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$===**!!!;;!!==!;$##$;;~~~:;;~.~-,-,-,.,.            .,!!==#***~..         .  ,      ..,......,-,..,.----,,,,~:;:;!*=*;~,,...,,,,~~:-;!!*=*==$*;;:;;!*=====*==$
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$=$$$===**!!!*=;==$==$#!=$;;:.~:--~~,~,..,.        . .  ,,;=$!-,..            .   . .......,..,--~~--,---,-.,-:**$$##$$*;--,.,.--,:*;;;~~;!!****!;;;;;;!!!**==$$
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$==$==*!!!!*=~=*$$###$!#=*:,;~~:~~,-~:,,          . ...,-~-=$~.-.,.            ..,. .......,--,,-::-:--,,,,,.,~!=*=$$$$$=;;--,.,-;:;:::!;;**!!;;;;~~~::;!!!**===
// ########$$$$$$$$$$$$$$$#$$$$$$$$$$$$$$$$$$=*****!;*!:*$##@$$#*$=!.:!:!!!--:~.~-,...    ....,.,,,,-~*$~-,,.-...           .. ..,.,,,..,,--~:;~.,-,,,,-:~~!!!*====;!!:::-:;:;*!:::!!=*=!;!;::::::;;;;;!!**
// ########$$$$$$$$$$$$$$##$$$$$$##$$$#$$$$$==******$!=#$=$$=@##=$;:!;:;~:-;:~-~-~-,....   ...,,-,,,-~=$!:-,-,,..        ..  . ...,-,,-.,,,-----,,-~-:~:;!!*=$$$###$**!;!!*~~~;~:;::;;!;;!!!;:::::::;;;;!**
// ################$$$$$$##$$$$$####$$#$$$$$====****!$$=*!!=$=$*!-!!*;:~,-~:.,,-~-.~--,,,,,..,,,,,---!===!.,,,-.  .      ..  .. ,.,,,,,-,~.--,,,--~~~:~-::;!;*!;;!$$$#@$!*;*!;:~~~*!=*!:;!!;;::::;;;;;;!!*=
// $#####$#########$$###$##$$$$#####$$$#$$$$$===**!!!!;;!!!=*=**~;;:;;~.-,-...---.~::,-.,.,.,---~-!:*===$=!;,-,,,,.,.  . .,. ..-,,....,-,,,. ,,.,.,:-,.~~~-~:!*$$=**==***=*$=!;:;!*!;!*!!!;;;::::;::;;!!*==
// $$$$$$$###################$$#########$$$$===*****====*$*!!;~;**!:~,,--,...,.,.-~:-;,:-,-,--;;~$##****==$=$!::,,.-...,.,.,,.,-~--,,.-,,.,........,.....~~~~~:;!**$=$$=!!;;!!;~:;!****!*!;::::;:::~~:!**==
// $$$$$$$$$$$#####$#########$$#########$$$======**=$$===**;;~;!*!:;-~~--.,,. . .,~:~;:;;;~~:$#$$=##*****===$$*=!*~- ..,..--,~~!!#*=!-,-,....    . ....., .,-~~~~:~!!;**$;;!;~;;:;!***==*;::::::~:::;!**!!*
// $$$$$$$$$$$$$$$$$$$$##$$##$$##########$$=====**===$$=$#!*!!!!;;;~::~,,-...   ..,-~-;;!!*:*#@#$$##!!*****====*=*!:~:--,,-;-!*$-$$*!:,....          .. ,,, ,:~:~~:;;;****!!!~;;=$$!=$$$=!;;;::::::;!!!!!**
// $$$$$$$$$$$$$$$$$$$$$$$$##$$$$####$$$$$$=$==*===*=$$#$$=**!!;!*:*=*::~-,.     ..,~~~;;!=$@#@@#$$$;;;!!***=*=****!!!;***=!*-=#$-=;:, .              ..,,,--:;*;**=!::!!;~~:;;;*#@#=$#$*!!;:~~::::;!!!****
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$=====**===$##@$$$*;**!!!=**::--,..     ..,~~~;!*###@@#=**:~~:;!!!!***!!!!!!*$$*;=*$$#$-;:,.                . ,,,-~~~!;!=!**!!!*~;!::=$#$=##*$=!;;;;!!!!!!!!!!***
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$===*=***=$$$$@#@@#=;!!;*=*::;~~--..   ...,-~~~;;=#@@##$=;-,-,--~:;!;!!;;;!;=$*!*;=$~!*!-,                . ,-,-::-;:~;!;;;~::!;;!!:$#=####@$**!!;;;;!!!!!!!!!***
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$=$$$$$$$$$$$$=**==***$$#@$##**$*!,;!!~:;~!~-.~....   ,,,-~~:;$#@#$=*,,,.,,--,,~~:-~-~~~$!!**,$$*:;:-               ..., -~:::;!;;:*-::;;!!;====*=@#$*=$$$$*!;;;;!;!!!!!*****
// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$=========$#@=@@##$$=~:~:,:;:::;:~--,..     ...,,,;$##$=;,,....,,.,,---,,-,-*****~$!*~:-.             ...~-,;,!!!*!;;;~:~::,~:*:=;##=#==$#$$*==*!!!!!!***********
// ==$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$#$$$==========$$#@##$*$=;::-~::~!!;~:!:,...        ...!$#==~,,..... ,. .,,.-,,-,-:!=*#:!:-,.         .. ...,,--~!;!!;!!;::-~-~-~~~:=;:=#=*=$#$$#$$==*!!*$$$=*****===
// ***====$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$==$=*******==#$$#=$*-;~~,-:~~;;~::!:~,....         ~==$=,,,...... ...,,,,,,,,-;*==$*;-.           .,..,--!-*=:;!**!::!:-~~--:===;$;!;!#$====#$=!!!!*$====*=======
// !!*****=====$$$$$=$$$$$$$$$$$$$$$$$$$$====*****!!!!*=#@@$$=:;;,:---:~:~;!::~~,-,,.         ;$=$,,,..,. .  .....,,,,-~!*=*=!-,         .. ..-::~::~~~;*!*~!;;~~~:~;~;:;=*=$*##**====$$***********========
// ;!!!!!!!******==**======$$$$=$$$$$$$$======**!*!!**=$=#$=*;~~:-.-,,--;;!:;:~~;--...       .-*$!-,,......  ..,.,,,,.;***$$*~-.         ....,-::~;=!!;;!;::-:~!!:!!!!~**!=!=*!=$$;**===**!*********=======
// ;;!!;;!!!!!!!!**!!!********================*****==$$$#$*=!---.,~-.,-;.::;:!!~:;~~,...       !$!,..,.......,..,,,,,,!*=$=*;-            .,,-;::::*!=;!;;~::-:!!;$==$;*$*#$$#*!==$#===********!**==*======
// ;;;;;;!!!!!!!!!!;;;!!!!!!!!!**!********==*==******==$$=!;:-~~~::-.:;;~;;;*!!;*!:-,,..       -*=,,,,,,.... .,,,,,,,!$$$=*~-.           .,-~~!~;!!::;:;:~~-~~-;*!;===#;$@#$*==!;;;!!!!!*!!!!;;!****=======
// !;;;!!!!!!!!!!;;;;;;;;;;;!!!;;!!!!!!!**********==**$$=!;~~~~-~:::~:;:~:;*!*!;;;!::~.,.      .!*--,,,,,,.....,,,--:$$#=!:-.         ....-~*!,!;:~~-,~:~-~~:;=-*;=$@=#$:$###$$$$**#$$=*!;:~::!**========**
// !!!!!!!!!!!!!;;;;;;;!!!;!!;;;;;;;;;!!!!!!*******!!**!!!;~~---~---~~:!!!*;;!:;::::;~;-.,     ..!-,--,,.,,,,,,,,,--=$$$*~-           .,-~-~;;:~;:~~~~~,~~~--~:$;#@=$=***~!!***=$###$$=*!!:;;**=$===$$$$=**
// ;;!!;!!!!!!!!!;;;;;;!!!!;;;:;;;;;!;;!!!!!!***===**!!!!;::~:~~~:~:!!****!:~~---~;;:~~~;- . ..  !:,,..,,,,,,,,,..,*=$!*;,.    .     .-,~,~;:;;,::~~~:~-:~*=*!;*=!$#=##$#$!!;**=#@#$$$=*!!!!;!!!!!*=$##$**!
// ;;;;;;;;;;!!!!;;;;;;;!!!;;;;;;;;!!!!!!!!!*****=*===*!::~--~~~~~:;;;:::;~~~:;~-,,-,--~~~-,..   *=.. ..,,,,.,.,,.;=**;:~        ...-,~-:;::::~~-,~-~~--~!:!##!==*!*$*#$*$=!=*$@#$$$#=*!!!!;~:!***=$##$=*!!
// ;;;;;;;;;;;;!;;;;;;;;;!;;;;;;;;;;!!!!!!!!****===*=$$*:::~-----~~:~;::::;!:~--,.  .,-~*~-,,,   !$:- ,,,.,,,.,,,,:*=**:.     ..,,~---::;!;:::--:~-,-~:*;!!!$$=!*$@=#=*=##$#=@@#=@#$=**!!!;;;;!*=$#$$=***!!
// ;;;;;;;;;;;;!;;;;;;;;;!!;;;;;;;;;;!!!!!********====*!;:~~~~-~------~-::;!::;~-~-,.-~:~!!:-,.  ;=*~,-,,,,,,-.,,-;!*$=-       .~-,!;;;:;~!:;:::::~:~~~~!!=$*=*=*!##$@#=!$$$@$=####$=*!!!!::~~::!*=$=**!!!!
// !!;;;;;;!!!!!;;!!;;;;!!!;;;;;;;;;;!!!*******=*=$$==*!;~~~--,,--------,---~~-~;;~~~~~~;*!;~,,. ~*$$;;;~:-,,-,:;!*===;,      .,,:!~*;;;!!:;!;!:~!!;!;**;!;**!;;=*!==**!!!;;*$$$=$$==*!!*!:~~:::;!!***!!;!!
// !;;;;;;;;!!!;;;!!!;;!!!!!;;;;;;;;!!!********==$$$$$*!:~~---,,----~;;~,~-:;*=!;:~:-,--;**;::~,  ~;=$$=$*=**=*====*!:-  .   . ,~:;!!:;;!;!*!**;=:!=*=**!!!:~~:!=*;!==*!;!;:;!*=$#$=*!!!!;:::;;!!!***!!;!!*
// ;;;;;;;;;!;;;;;;;;;;;!!!!!;;;;;;!!!*******=====$$$$=!;;;~:~-------~:;:~-~:!**;:~-,.,~:!:*!!!:  .~--:==!~,!*;!;;::-,.   . ..~-:;:;;:*:;!;!$=$!#=*==*;!!!;;:;***!**==**!;;!!!*=##$=*!!;;;;:~~:;!!****!!***
// ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;!;!!*******=====$$$=$*!::~~--,,,,-~~;**;;::!***~:-...,~~:!=$=:,...,~~--:~~~,~~,,,,,.    ,,,~;~!!!:!;:*!;*=$$$$===*!!*;;:;;!;;;!**!*!;;::;;!***$#$***!;;;:::;;!!****====**
// !;;;;;;;;!;;;;;;;;;;;;;;;;;;!!;;!!!!**!***====$$$=$=*:~---,,,.,-~~-:;;;:~::!;;:~,.,,--~::;;=!~,.  ,,-,,~~,~-~,. .  .. .,~~;!*~*;;!!;!**!*=$$$!=;!;*;;~;;!*!!==*!;::;:~~:;!****==**!*!!:::::;!*=$=====***
// ;;;!;;;;;!;;;;;;;;;;;;;;;;;;!!;;;;!!!!!!***==$$##$#$*!!~~-----~~::;~-~--,--~;;~-~-~-,.-~~;:*!;-..,.,.,,,,-,.   ...  ,,.;;!;*;!!!!~=!;!*!=*$===!!=!:~:~~;;*!=*;;;::::;;::!****!!!!;!!;;:~~::!*=$$$==****=
// ;;;;;;;;;;;;;:::;;;;;;;;;;;;;;;;;;!!!!!*!***=$$####@@#!:~---~~~;;;;-,~-:~~~~~-~~~;~-~-,-~~:;;*;~-,. ... .  .,. ...-,,-!~;!**!*~:;;;*!*;**=*=*!!!!!~~:;;;!!*!!:::~~--~~:;;;:!!*$=*!;!!;:::;;!!*====*==**=
// ;;;;;;;;;;;;;:::::::::;;::::;;;:;;;!!!!*****=*==$=$$##$*;::~!!!!;:~,-::~~--~-:~~:;::~---,~~:;!!;:-,.. ... .....,.-:::;:=;!!!;;!~::;;:!!;;!!!::;~:::::~:::;;::~-----~~~~~;:;;!**!!!;;:;:::;;!**========*=
// ;;;;;;;;;;;;;:::;;::;;;;::::::::::;;!!!!****==$$#####$*;;;;:;!;:~~~---~-~-,~~--~::::~~-~~--~:!**;-:,...  ....,.~:~!*;*!!!!!;::::~~~;~:;;;;;;:~~-~~~:;;!!!;:~~-,,,,,-~~:::~::;!**!!!!!;;;;!**==========**
// ;;;;;;;;;;;;;:;;;;::;;;;:::;;:::;;;;;!!!****==$===$##$$*!;;:;:;:~~~~-,,,-,,~~:~--~;~:~-:~:~~:!**!:;----..,,,,~-~!!=$***!*;:;~~-~~--~~::~:!;::-:~-~-;;;!!;:~:-,,---~~:;!;::~:!**!*!;!;;;!****======******
// :::;;;;;;;;;;;;;;;::;;;;;:;;;;:;;;;;;;;!!**======$$$=**!!;!;:::~::::---,..,,,.-~:!;;:;;;;:~:::!!*!*;;!~~-~-~::*~*===***;;;~:--,,-,,,~:::~~:;~~--;:~~!;!;~~--,-.,.,-::~:::::;!**!!*!;;::;!!*======***!!!*
// :::::::::;;:::::;;;:;;;;;::;;;::;;;;;;;;!!**===**==**!!*!;::::~~~~::::~---,,.-~~;;;!=!**!~;~~!;;;*=*=*!-!::;!~*:=!=!*!;~~~~--,,,--,,,-~-~~-~~-~~;~:*:!;!!:-,,,,,-:::;**!;:;!=****!!!!;:;*=$$###$$==*****
// :::;;:::;;::::::::::::;;:::::;::;;;;;;;;;!***===**!;;!;:~~~~~:::::~:~-.,,.,,-~:;::;!*==!=~;-:;::;*==**;*=!!*=***!**!;;;~--~-~,,.,-,,,,,,---~~~::~:*!:::;:~----,-~~;!!!**!!;;=#$==!;;;;!!=##@@@##$=======
// :::;;:::;;:::::::::::::::::::::::::;;;;;;!!***!;~---~---~~~~:;;!;;;!:;:~--,,.,-~~:~;**;*!*;~~::-=====*===$=$==*****!;:~~,--,,....,,.,-,-,----~:*=:!!::~~~~--~~:;;!*=$$=*==$=$@#$*!;;:~~:!=$####$$=*=====
// :::;;:::;;::::::::::::::::~:::::::::;;;;;;::~:~-----,----~~:!**!!!*!;:~--..,,--~:;;~;!!==*!!;~,;==*$=**=$$===**!;!;:;~~--,-,,.....,,,,--~,--~--;!*;!!~~--~~~~;!!!!;!;;;;;!=##$==*!;;;!!!**==$$$$$$$$====
// :::;;;:;;;;:::::::::::::::~~:::::::::;;;;;;;::-.,...,--~:;!*$##$=!*;:~-,---,,,-~~~~!;;!!!=*!~;~*$=!*****=*==*!!!;;:~:~-,,,-.,.......,.--~~-~~;:!:;;::::,.,,~:;;;;;;;!**;!*=$@@@$=!;!!**=***=$$$=$##$$$$$
// :::::::::;::::::::::::::::~~:::::::::;:;::~~---,....,,:!=*=*#$#$=*!;;:;;;:-,,,,,-~:::!;;!!!~*~$==$!*!*!***!*!;;;:;~-:~--,,-,.,.....,..,~:~:;;;;!*!:;:::::--~--~:~~::~~:!!*$@@@@=!;;;;!**$$=$$##====$====
// ::::::::::::::::::::::::::::::~~:::::::::::~-,,,,,,...-::!**=$$##$$$#$$$!:--. ,,,---~~-:!;~:*=*$$!**;!!=*!!;;:::~~--:--,,,~,,,,,,,,,,.,:;!;;!:!;;!!::-~;:~:;:::~-,-~::~~;==$##=!!;:::!*$$$$==$$$$==**=**
// ::::::::::::::::;;::::::::~::::~::::::::;:~~~~:~~-,,,,,,-~;;=###@@@#$#$!;;~-,.   .,,-,:;::~!!=!**$=;!!=!!;;;:~:~-~-----.----,,,,-,,-~-~~;;!!;;~:::::;:;~~:;;;;~~~---~::!!;!*===!;:::~:;*$$==*=====*****=
// ::::::::::::::::;;;;::::::~~:::~~~:::::::;;;;;!!:~-,..,,-~!!=====$##====*!-,. ......-~-~~~;:;!;!==*!!!*;*::;:::~~~-~--~,-~~~-~--~-~-:~~:!:;!!!~~:~;:;;::;;::~:::!!;::;!!!!*!!!**!;:::~:*=***!!!!!*!!;;;;
// ::::::::::;;::;;;;;;;;:::::::::::::::::::::!**$*!:~~---,,,~~~~:;*$#@#=#$*;~,.......,,,--,~~;~:;*!=*!!;*;!;:;;;~~-~-~-~~--:~~;~~--:~;:!~;:!:~~;;~!:~:~:~~~::~-~:!!!==*!!;;;;**!!!!;:~:::!**!;;;::;:;:::~~
// :::::::::;;;;;;;;;;;;;;::;::::::::~~::-~::!==***!*;-,.......,,~*=##@=@#$*:---,... .....,,-:~~~!;;!!;;;*;!:;::;~~:---~~~:~:~:;-;-~~::;;::;;::;::~;;!:~:~~---.,,-;!*#$$*!:;~~:!!!;;!;:::;;!!!;;:::::::~~~~
// ::::;:::;;;;;;;;;;;;;;;;;;::::::::~::~~~~;*=$#$=!*!::~,.....-~:!$##*###$!::~,.,,..   ...,--~~~!~;;;;:~;:;::~-:~~~.,-~:~:~:~:;;:--~;:;:~~:~;:;;!;~:::::~--,,,,-::!**$$=*!:~:::!!*!;;;::!;;;;;;;:::::~~:~~
// :;;;;;;:;;;;;;;;;;;;;;;;:::::::::::~:::~~;*=====$$$*;~--,....-:=$$*$##===!:;~--...  ....,,-::~~~~::~-~--~~~~~~~--.,,,--~-~-~~::~-~~~:~-,:~::;!;;;~-::~~~~~--,,-;;*=**!!;::;;;!***;:~::;!;;;:::::::~~~~::
// ::;;;;;;;;;;;;;;;;;;;;;:::::::~~~~::~~~~:;:;!****=====;~-,,,,:;!==#@@@@#$=!:~:-..... ....,~::-~~-:~-,,,,------,,,,,,,,,,,,,,--~-,---~,,--~~:!*;~~;:-~~~,,-~~-,,:=!*=!;::~::;;;!!*;~~~:;;;;;::::::::~~:::
// ::::::::::::;;;;;;;;;;;:::::~~~~~~~~~~~:;:~::!!*=*;:;!*;;~--,-~:;*$#@#$#$###*;-,....,.. .--:~~;~-~--,,,,,-,,,,.,,....,......-,,-,,,,,--~~::~~::~--:!::~-~-~~::~ :=;!!!;~~:;!!;!!!:~-~~:;;:::::::~:::::~:
// :::::::::::::::::;;;;;;;:::::~:~:::~,-~-~~--..,-~;!$===*!:~,,,,,~;=$$#@@@@@#*~-,-----.....---~-~~~---,,,,.,,,,.......,......,,-,-,.,,~,,~:~:~-~---::;::;*!::!==!,,:~;::;;;!===*!!:~-~~~::::::~~~~~~~~:~~
// :::::::::::::::::::::::::::::::~~~~~-,,.,... ..,,-~;!==*!!;~--,,-:!==$@@@$==!::~:~~~,,,..,,,--~~~~~--,-,...,,,,........,..,.,,--,,,-,,;~,:;~~~~:~~,-::*$!!*=;;;:;~-~::;;!*!!!!!!!;~~-~~:::~:~~~~~~~~~~~~
// ::::::::::::::::::;:::::::::::~~~~~~~~-,... . . ..,-:!!!!*!;:~~-~~~:;*$=$##=##$$;!~,--,-----.,-::~-----,,.,,,,,......,,,,.,.,~---.~~~~-!~:~*:~-:!!!:--~-~:=*=!;!!;:~;!:::***!!*!*;:~-~::::~~~:::~~~~~~~~
// ;::::::::;;;;;;:;;;;:::::::::::~::~--,,,,,,,..   ...-:!*==*==*;~,,---;=##@#@$*=$$*:;;~~~:-!~.,:~~-----~-,,-,,.,...,..,,,,,,,~~-~-~~;;;~:::::~::~;=$=*;~~,,--:*=*!!**!!!*;!!!!*!!!!!::;;:~~~~~~::::~~~~~~
// ;;:;:;;;;;;;;;;;;;;;;;;;;:::::~~~~~--,.......... ...,~*$##@@@#=$*:~-;*!!$##$*##$*!::!;:;:;*~,-;--,-,-,~-,,-,,,..,,,.,,,~,--~~::;:;~~~:~--,,,,--:~:!*=#$=!~-,,--!*;;=$$$$#******!****;!!:~~~~~~:::::~~~~~
// ;;;;;;;;;;;;;;;;;;;;;;;;;;::::~~~~---,,.,.....     ..,~*#@@@@@@@=$:~~-~;=*!!**!!!~;::;;;;!!--~;--,,.-,-,,,-,,,,.-..,,,-~-~-~:!;!!:~-,,,,-~~~--,,.,-:***$=*~,,,,,-~:~*=#@@@=***!***$$*;;:~~~~~~~:~~~~~~~~
// ;;;;;;;;;;;;;;;;;;;;;;;;;;;:::~~~~----,,,,........    .,:*$@#@@=$**~~~:;!::::~:!~;~-~~;:*!!:::;~--,,-,,--,--,,,.,,,,,----~-~;;!!;--,,,,,~:~;!!:-,,,,-:##*$*:,.,,,,-~:*$$$$=*!*$#$*=#$!;:~~~~~~~~~~~~~~~~
// ;;;;;;;;;;;;;;;;;;;;;;;;;;;::::~~~~~~:~~,,,,........     -:*$#@@=**=~:-~~~--,~:::-,.,~~;!!!;;;;:-~-~-~---,--,,,.,,,,,--,-~::~!;------,-,-:!*!!;~-,,,-~;=#*=*:~-,,,,:;!:=!!;!!!=#=;$##=!:~~-~~~~~~~~~~~~~
// ;;;;;;;;;;;;;;;;;;;;;;;;;:;:::::::::***=!~-,,.......   . ,-;*$=$@@@**~~~~,~,,~:~,,...--~;:!;;;;:~:~~,~~~-,,,,,.,,-,,,,-,-:;-:~~--;;::-,,-~~:*=!!;~--,,~!!$#*;:~-,,,-,:*!!!;;!!*$*~$#=!;:~~~~~~~~~~-~~~~~
// ;;;;;;!;;;;;;;;;;;;;;;;;:::::::::!**$#@@@=*;;-......    ...-~~*$##$#!**:-:-~~~-,... .,,~:~::;;:::;:~~~~~~,,,.,,,-,,,,----;~;;~--:;!:~--,,,--:!==*;:~-,,-:$$$;-~:~,,----:;!!*;;:=!~!!!::~~~~~~~~~~~~-~---
// ;;;;!!!;;;;;;;;;;;;;;;;;:::;::::!*$#$$@@@@@$*:-,,.....   ....,~;*=@@@@#=*!;;!~-........~~-~~:;:~:;:-~~---,,..,,,,,,,,---:;!!,,-~:::~--,--~::--~~;!*:~--,-:*==!~-~-..-~:;!**=$;:!:-~~~~------~~~~~~~~----
// ;;;;;;!;;;;;;;;;;;;;;;;:::::::;!*!=@=@@@@@@@@@$;~-,,...  .....,~*=@@@@#@=$*$=~--.,,.. .,,,--~;:-:~~~----,,...,,,,,-,,~-~;;*~,,~:;~:~---;;;:;:-,~;!#$;:~~-~:$@*;:~~-,,,~!=$==*;:~~------------~~~~-~~~~--
// ;;;;;;;;;;;;;;;;;!;;;:::::::::;*==!=!*$@@@@#@#$$=;:~--,........-~*$@@@@@@#$@=:~;,,~..  .,,,--~;-~~~~----,,...,.-,,,,-~:!!;;---:;;::~--,-~~;~;:-,--~$=;:~:-~:!=*:;:---,-;$$=!;:~~~~--~----~----~~~~------
// ;;;;;;;;!;;;;;;;;;;;;::::~:::::!*!!~!~;*@@@@@@@@@@#**!;:-,.....,~!##@@@@@=@@#;-*-:~,.....,,,-~~~-~~----,-,...,,-,,--~;*;;:----~~-;;;~;~:~~~~~~;~-,,~~=#=!::~;*=*:!!~~~-~;**;::~~~~----~----~----~-------
// ;;;;;;;;;;;;;;;;;;;;;::::~::::::::~--~-~;#@@@@@@@@@@@@#$*:-,.. .-;=#@@@@@@@@@**$:;~~,.,..,--~-;~,-~-,-,,,,...,-,,,,~!*!;!;------:;!*!!:;::~~~~:;:,,,-~=#**!;:;$**:;!;;;~::;:~~~~~~----------------------
// ;;;;;;;;;;;;;;;;;;;;;::::~~:::~~~--~,,-~:!$=#@@@@@@@@@@@#*;:,...,~!##@@@#@@@@#@=$=;!~-,-,,,~:~;~~--,,-,,,,,.,,-,,--:!!!=*:~-----~~:~~~~~-~~~~~~:-,,,,,-~;*==;~!#=!:;*!!;;;:~~~~~~~------------~~-------~
// ;:;;;;;;;;;;;;;;;;;;;;::::~::~-,,--,-,,,-:!*=#@@@@@@@@@@@#$:,...,~*=$$@@@@@#@@@@#**$!~-----~:!;;;~-,-,,,,,,.,,-,-~~;;;!*;~~,---~~--~-,-~~~~*!;;:;~~,.,,,,:;!;:~;**;;!*;!;;:~~---~----~---~---~~~--------
// ;;;;;;;;;;;;;;;;;;;;;;::::::~~-------,,-~;!=@@$@@$@@@@@@@@@=-....~:***#@@@@@@@@@@@=#*!:,-~-:!=!!*~~,-------,-----;;=!;~;~~~~~~-~~:~--,----~-~:;;;;:-,...,-;!:--:;*=!*;*!;:~~--------~~~------~~~~~~~~~--
// ;;;;;;;;;;;;;;;;!!;;;::;;:::~~---~-----,-~~;*$###@@@@@@@@@@$~...,-~!!!$@@@@@@@@@@###=*!--~:;====!!;~:~-~~-~--,~~:**!!~~--~:;~;~~~:~~--~---~:!:::-:~~--.. ,~;:~~-;:=***:::~------------~------~~~~~~--~--
// :;;;;;;;;;;;;;;;!!;;::;;;;;:~~--~-~~---,,,-:=@$@@@@@@@@@@@@=:....--~:;*@@@@@@@@@@$#==$=:~~;$=#$#$=*;=:~:;::~~-::*!!;:--~-,,~~-~-~~------~;:;-;----~-:-,,..,-;:-~:*;***;::~~---------------------~------~
// ::;;::;;;:::::;;;;;;:::;*!;;;;:~~::~~~,,,,--~!**#$$=#@@@@@@#:,..,,--~~!##@@@@@@@@$#$===!:;;##@#=$#=!@!:;;!;~:~!*=**~---~~-,---~~--~--~~--~-,-------~~-,,,,.,-::-~;*;*!;::~~------,----------------------
// :::;:;:;;;;::;;;;;;:::::!*;;;;:;;:=!*;~,-,,,--:**!$#@@@@@@@@!,.,,,----;$#@@@@@@@@$#$===$;!*##@#=$$$*$!==*!*:::!*$*:~-~~-------~~~~~:::;:~~---,-~~~~,-,,.,.,,::~::;*!;;:::~~-----------------------------
// :::;;;:::;;:;;;;;;;:::::;:;***=!=*=@@*=*~;;:-----~:!#@@@@@@#=-,,,,.,,,:$$@@##@@@###$#*=$=$=$$==**=****==*!*!;;**!!!~~~---~~~:---~!!;::;!:--~-~~;;;~~-,----,,,~:~!;;;::~~:~~~-----------------~~---------
// :;;;;;:::;;:;;;;;;:::::~~~:*=#@@$##!*##*!=;;;~~-----*@@@@@@@=-,,.,..,.~#=#@@#@@##$###$$#@$*=**!!!;!;!;***;*!!!;*!!~~~~-~~!;!;!~~:;;~~~:~!~~!~;-~:;:~-~--~-,,,-~::;;;:~--~~~-----------,-----~~~~--------
// ::;;:::;;;;;;;;;;:::~~--~-;~;=$$=!!!;;;;!;::::~-,,~,~!#@#@@@=-,.....,.~$$=#####@########@=*!!;::::::~~::::!;;;;;:~~~::;::;:;:::~:*::~~~;**;;::;;:-~;:--,--,,,-:::~~:~~~-~~~~~---------------~~~~--------
// :::;::::::::;;;;;::;:--,----,~!$==!;~~::~!:::~~---,-:*@@@@=@=-,......,~$$*#####@##=##@@$$*!!:~~~~-~~~~~-~~~~:::~~-~~--~;:;:~:;:;!:~~-~;:;;;;!~::~:;;;~--,~--~~::;~~-~~----~~~-------,,,,,--------------

class Connect4 {                        // This is constructing the board. The constructor method is a special way of creating and initialising an object crated within a class
  constructor(selector) {               // If this doesn't work blame Theo
    this.ROWS = 6;                      // define the size
    this.COLS = 7;
    this.maxPieces = 4;
    this.player = 'red';                // starts with red player
    this.selector = selector;           // If this doesn't work blame John
    this.isGameOver = false;            // gotta start with false because of synchronicty === sucky
    this.onPlayerMove = function() {};
    this.createGrid();
    this.setupEventListeners();         // If this doesn't work touch Joel's arm until he get's uncomfortable and fixes it for me.
  }

  createGrid() {                                // Build the divs here
    const $board = $(this.selector);            // Grab the DOM element
    $board.empty();
    this.isGameOver = false;
    this.player = 'red';
    for (let row = 0; row < this.ROWS; row++) {   //Build the rows until 6 defined earlier
      const $row = $('<div>')                     //For every row create a div in the DOM, add classnme ROW
        .addClass('row');
      for (let col = 0; col < this.COLS; col++) { // Build columns until we get 7 in each row
        const $col = $('<div>')                   // same create a div as before
          .addClass('col empty')
          .attr('data-col', col) // give an  attribute to each col so I can do something with them later
          .attr('data-row', row);
        $row.append($col);
      }
      $board.append($row);
    }
  }

  // DEATH TO SQUARE BRACKETS!


  //Thought process...... generate DIV's in a col, populate with rows, instead of positioning, give classes,
  // change properties based on classes
  // for hover over, have a cool mouse icon
  //

  setupEventListeners() {
    const $board = $(this.selector); // You forgot the $ you idiot. Remember it's Jquery
    const that = this;              // Don't do that again.

    function findLastEmptyCell(col) {
      const cells = $(`.col[data-col='${col}']`);
      for (let i = cells.length - 1; i >= 0; i--) { // loop over all these backwards
        const $cell = $(cells[i]);
        if ($cell.hasClass('empty')) { //look thru the empty cols [i] bring back the value if its empty
          return $cell;
        }
      }
      return null;
    }

    $board.on('mouseenter', '.col.empty', function() { // hover on, populate the div by adding a class
      if (that.isGameOver) return;
      const col = $(this).data('col');
      const $lastEmptyCell = findLastEmptyCell(col);
      $lastEmptyCell.addClass(`next-${that.player}`);
    });

    $board.on('mouseleave', '.col', function() { // once we hover away, remove the next player
      $('.col').removeClass(`next-${that.player}`);
    });
// when we click an empty col, replace the temp image and remove the class.
    $board.on('click', '.col.empty', function() {
      if (that.isGameOver) return;
      const col = $(this).data('col');
      const $lastEmptyCell = findLastEmptyCell(col);
      $lastEmptyCell.removeClass(`empty next-${that.player}`);
      $lastEmptyCell.addClass(that.player);
      $lastEmptyCell.data('player', that.player);

      const winner = that.checkForWinner(
        $lastEmptyCell.data('row'),
        $lastEmptyCell.data('col')
      )
      if (winner) {
        that.isGameOver = true;
        alert(`Game Over! Player ${that.player} has won!`); //use Alert.render and tab-in the alert javascript
        $('.col.empty').removeClass('empty');
        return;
      }

      that.player = (that.player === 'red') ? 'yellow' : 'red';
      that.onPlayerMove();
      $(this).trigger('mouseenter');
    });
  }
// check for winner, use i for rows and j for cols,
  checkForWinner(row, col) {
    const that = this;

    function $getCell(i, j) {
      return $(`.col[data-row='${i}'][data-col='${j}']`); // takes that cool method from before
    }

    function checkDirection(direction) {
      let total = 0; // set a total as zero and while loop your way up from there
      let i = row + direction.i;
      let j = col + direction.j;
      let $next = $getCell(i, j);
      while (i >= 0 &&
        i < that.ROWS &&
        j >= 0 &&
        j < that.COLS &&
        $next.data('player') === that.player
      ) {
        total++;
        i += direction.i;
        j += direction.j;
        $next = $getCell(i, j);
      }
      return total;
    }

    function checkWin(directionA, directionB) {
      const total = 1 +
        checkDirection(directionA) +
        checkDirection(directionB);
      if (total >= that.maxPieces) {
        return that.player;
      } else {
        return null;
      }
    }

    function checkDiagonalBLtoTR() { //diagonal checkwin BL - TR
      return checkWin({i: 1, j: -1}, {i: 1, j: 1});
    }

    function checkDiagonalTLtoBR() {
      return checkWin({i: 1, j: 1}, {i: -1, j: -1});
    }

    function checkVerticals() {
      return checkWin({i: -1, j: 0}, {i: 1, j: 0});
    }

    function checkHorizontals() {
      return checkWin({i: 0, j: -1}, {i: 0, j: 1});
    }

    return checkVerticals() || // woo hoo for comparison operators
      checkHorizontals() ||
      checkDiagonalBLtoTR() ||
      checkDiagonalTLtoBR();
  }

  restart () { // add this to the button click with a listener, create grid and reload the on player move
    this.createGrid();
    this.onPlayerMove();
  }

  gameBigger () { // reuse the restart button,
    this.maxPieces = 5; // change max pieces\
    this.ROWS = 7; // increase rows
    this.COLS = 8; // etc etc yadda yadda
    this.createGrid();
    this.onPlayerMove();
  }
}

// function customAlert() {
//   this.render = function(dialog) {
//     let winW = window.innerWidth;
//     let winH = window.innerHeight;
//     let dialogoverlay = document.getElementById('dialogoverlay');
//     let dialogbox = document.getElementById('dialogbox');
//     dialogoverlay.style.display = "block";
//     dialogoverlay.style.height = winH+"px";
//     dialogbox.style.left = (winW/2) - (550 * .5)+"px";
//     dialogbox.style.top = "100px";
//     dialogbox.style.display = "block";
//     document.getElementById('dialogboxhead').innerHTML = "Hey buddy what's happening";
//     document.getElementById('dialogboxbody').innerHTML = dialog;
//     document.getElementById('dialogboxfoot').innerHTML = '<button onclick="Alert.ok()"> Yeah... ok</button>';
//   }
//   this.ok = function(){
//     document.getElementById('dialogbox').style.display = "none";
//     document.getElementById('dialogoverlay').style.display = "none";
//
//   }
// };
// let Alert = new customAlert();
